<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

<link rel="import" href="../bower_components/google-map/google-map.html">
<link rel="import" href="../bower_components/google-map/google-map-marker.html">

<link rel="import" href="../src/aptcopilot-carousel.html">

<dom-module id="aptcopilot-property">
    <template>
        <style>
            :host {
                display: block;
                margin: 20px;
                height: 90%
            }

            .property-header-title {
                text-align: center;
            }

            .property-header-info {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                grid-gap: 50px;
                grid-auto-rows: minmax(auto, auto);
                margin-bottom: 20px;
            }

            .property-header-pic {
                outline: 1px red solid;
                grid-column: 2;
                grid-row: 1;
            }

            .property-header-basic {
                grid-column: 1;
                grid-row: 1;
                padding: 15px;
                font-size: 20px;
            }

            .property-header-basic div {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 10px;
            }

            .property-header-owner {
                grid-column: 2;
                grid-row: 1;
                font-size: 20px;
            }

            .property-header-owner .private {
                -webkit-filter: blur(5px);
                -moz-filter: blur(5px);
                -o-filter: blur(5px);
                -ms-filter: blur(5px);
                filter: blur(5px);
            }

            .property-header-owner div {
                padding: 10px;
            }

            .property-content {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                grid-gap: 50px;
                grid-auto-rows: 300px 300px 1fr 1fr 1fr;
            }

            aptcopilot-carousel {
                grid-column: 1;
                grid-row: 1;
            }

            img {
                width: 100%;
            }

            .property-content-units {
                grid-column: 1;
                grid-row: 2;
            }

            .property-content-units th {
                font-size: 20px;
                padding: 5px;
            }

            tr {
                text-align: center;
                line-height: 3em;
            }

            .property-content-map {
                grid-column: 2;
                grid-row: 1 / 3;
            }

            .property-content-ratings {
                display: flex;
                justify-content: space-around;
                grid-column: 1 / 3;
                grid-row: 3;
            }


            .property-content-rating {
                display: flex;
                justify-content: space-evenly;
                border: 1px solid black;
                border-radius: 5px;
                align-items: center;
                padding: 15px;
                width: 150px;
            }

            google-map {
                height: 100%;
                width: 100%;
            }
        </style>

        <div class="property-header">
            <h1 id="name" class="property-header-title">[[property.Name]]</h1>
            <div class="property-header-info">
                <div class="property-header-basic">
                    <div>
                        <span>Units: [[property.Units.Total]]</span>
                        <span>Year Built: [[property.Year]]</span>
                    </div>
                    <div> Address: [[property.Location.Address]]</div>
                    <div>
                        <span>City: [[property.Location.City]]</span>
                        <span>State: [[property.Location.State]]</span>
                    </div>
                    <div>
                        <span>Zip: [[property.Location.Zip]]</span>
                        <span>County: [[property.Location.County]]</span>
                    </div>


                </div>
                <div class="property-header-owner">
                    Owners Information
                    <div class="private">
                        <div>
                            <span>[[property.Owner.Name.First]]</span>
                            <span>[[property.Owner.Name.Last]]</span>
                        </div>
                        <div>[[property.Owner.Phone]]</div>
                        <div>[[property.Owner.Email]]</div>
                        <div>[[property.Owner.Notes]]</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="property-content">
            <aptcopilot-carousel images=[[property.Images]]></aptcopilot-carousel>
            <div class="property-content-units">
                <table>
                    <tr>
                        <th>Units</th>
                        <th>Bed/Bath</th>
                        <th>Size</th>
                        <th>Rent Monthly</th>
                        <th>Rent per SF</th>
                    </tr>
                    <template is="dom-repeat" items="[[property.Units.Breakdown]]">
                        <tr>
                            <td>[[item.Units]]</td>
                            <td>[[item.BB]]</td>
                            <td>[[item.Size]]</td>
                            <td>[[item.Rent]]</td>
                            <td>[[item.Rentpersq]]</td>
                        </tr>
                    </template>
                    <tr>
                        <td>[[property.Units.Vacant.Units]]</td>
                        <td>Vacant</td>
                        <td>[[property.Units.Vacant.Size]]</td>
                        <td>[[property.Units.Vacant.Rent]]</td>
                        <td>[[property.Units.Vacant.Rentpersq]]</td>
                    </tr>
                </table>
            </div>
            <div class="property-content-map">
                <google-map fit-to-markers api-key="AIzaSyDwZt-Shm5g3q8oCNYX6vQ97jo81FIrij4" latitude="[[property.Location.Latitude]]" longitude="[[property.Location.Longitude]]"
                    disable-default-ui>
                    <google-map-marker latitude="[[property.Location.Latitude]]" longitude="[[property.Location.Longitude]]"></google-map-marker>
                </google-map>
            </div>
            <div class="property-content-ratings">
                <template is="dom-repeat" items="[[property.Ratings]]">
                    <div class="property-content-rating">
                        <div>[[item.Name]]</div>
                        <div>[[item.Rating]]</div>
                    </div>
                </template>
            </div>
        </div>

        <iron-ajax auto url=[[url]] handle-as="json" last-response="{{property}}" debounce-duration="300"></iron-ajax>

    </template>

    <script>
        class AptcopilotProperty extends Polymer.Element {
            static get is() { return "aptcopilot-property" };

            static get properties() {
                return {
                    url: {
                        type: String,
                        value: config.apibaseurl + "/properties/1"
                    },
                    property: {
                        type: Object,
                        value: {}
                    }
                }
            }


            handleResponse(e) {
                console.log(e)
            }

        }

        window.customElements.define(AptcopilotProperty.is, AptcopilotProperty);
    </script>