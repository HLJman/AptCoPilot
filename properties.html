<!doctype html>

<html>
	<head>
		<title>Apartment CoPilot</title>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <link rel="icon" href="images/favicon.ico" type="image/gif" sizes="16x16">
        <link rel="stylesheet" href="css/properties.css">
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDwZt-Shm5g3q8oCNYX6vQ97jo81FIrij4&callback&libraries=places"></script>
        
        
        <script src="scripts/querymap.js"></script>
        
    
        
	</head>

	 <body>
         
        <div>
        <!-- Logo for Carpenter Commercial -->

        <img src="images/Horizontal-Logo---Website.png" class="logo">
    
    </div>    
        
    <div>    
        <!-- Main Menu -->
        
        
        <ul>
        
            <li><a href="index.html">Hub</a></li>
            <li id='active'><a href="properties.html">Properties</a></li>
            <li><a href="people.html">People</a></li>
            <li><a href="properties.html">Map</a></li>
            <li><a href="properties.html">Query</a></li>
            <li><a href="properties.html">Rent Survey</a></li>
            <li><a href="index.html">News</a></li>
            <li><a href="contactus.html">Contact Us</a></li>
        
        </ul>
        
    </div> 
         
    <div>
        <h2>Property Map</h2>
             
    </div> 
         
                    
     <div id="containerdiv">
         <div id = "containerelm">
         <button class = "containbtn" type="button">Show All Properties</button>
         <button class = "containbtn" type="button">Show Market Rate Properties</button>
         <button class = "containbtn" type="button">Show Affordable Properties</button> 
         </div>  

       <!-- Map DIV START -->  
         
         <div id="map" class="frontmap">
        
       

        


    <script>
      
        
        
        var customIcon = {
          url: "images/mapdot.png"
          };
          
        function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
          center: new google.maps.LatLng(40.354528, -111.757338),
          zoom: 6
        });
   
            
        var infoWindow = new google.maps.InfoWindow;

          // Change this depending on the name of your PHP or XML file
          downloadUrl('php/propmap.php', function(data) {
            var xml = data.responseXML;
            var markers = xml.documentElement.getElementsByTagName('marker');
            Array.prototype.forEach.call(markers, function(markerElem) {
              var id = markerElem.getAttribute('id');
              var name = markerElem.getAttribute('name');
              var address = markerElem.getAttribute('address');
              var type = markerElem.getAttribute('type');
              var city = markerElem.getAttribute('city');
              var units = markerElem.getAttribute('units');
              var county = markerElem.getAttribute('county');
              var mainpic = markerElem.getAttribute('mainpic');    
              var point = new google.maps.LatLng(
                  parseFloat(markerElem.getAttribute('lat')),
                  parseFloat(markerElem.getAttribute('lng')));

              var infowincontent = document.createElement('div');
              var propname = document.createElement('h1');
              propname.textContent = name    
              infowincontent.appendChild(propname);
                
             var wunits = document.createElement('h3');
                wunits.textContent = "Units: " + units
              infowincontent.appendChild(wunits);    

             var propaddress = document.createElement('h3');
                propaddress.textContent = "Address: " + address
              infowincontent.appendChild(propaddress);
                
             var propcity = document.createElement('h3');
                propcity.textContent = "City: " + city
              infowincontent.appendChild(propcity);  
              
             var wtype = document.createElement('h3');
                wtype.textContent = "Type: " + type
              infowincontent.appendChild(wtype);
                
             var propimage = document.createElement('img');
                propimage.setAttribute("src", "http://localhost:8888/proppics/"+mainpic)
                propimage.setAttribute("width", "400");
                propimage.setAttribute("height", "228");
                propimage.setAttribute("id", "pic");
             infowincontent.appendChild(propimage);
                
                
                
              var icon = customIcon
              var marker = new google.maps.Marker({
                map: map,
                position: point,
                icon: customIcon,  
              });
              marker.addListener('click', function() {
                infoWindow.setContent(infowincontent);
                infoWindow.open(map, marker);
              });
            });
          });
        }
        
      //Add border to map
      document.getElementById("map").style.border = "1px solid #018ED0";
        
      document.getElementById("map").style.marginRight = "10px";      
          

      function downloadUrl(url, callback) {
        var request = window.ActiveXObject ?
            new ActiveXObject('Microsoft.XMLHTTP') :
            new XMLHttpRequest;

        request.onreadystatechange = function() {
          if (request.readyState == 4) {
            request.onreadystatechange = doNothing;
            callback(request, request.status);
          }
        };

        request.open('GET', url, true);
        request.send(null);
      }

      function doNothing() {}
               
         
    </script> 
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDwZt-Shm5g3q8oCNYX6vQ97jo81FIrij4&callback=initMap">
    </script>
    </div> 
    <!-- Main Map DIV END -->        
    </div>       
         
  </body>
</html>